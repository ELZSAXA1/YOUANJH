<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Pide un Deseo ✨</title>
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&family=Poppins:wght@300;500&display=swap" rel="stylesheet">
    <style>
        body {
            margin: 0;
            overflow: hidden;
            background: linear-gradient(to bottom, #0f2027, #203a43, #2c5364);
            font-family: 'Poppins', sans-serif;
            height: 100vh;
            width: 100vw;
            cursor: pointer;
            touch-action: none;
            -webkit-tap-highlight-color: transparent;
        }

        /* Texto de instrucciones */
        .instruction {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: rgba(255, 255, 255, 0.8);
            font-size: 1.2rem;
            pointer-events: none;
            animation: pulse 2s infinite;
            text-align: center;
            width: 90%;
        }

        @keyframes pulse {
            0%, 100% { opacity: 0.5; }
            50% { opacity: 1; }
        }

        /* Estilo de la linterna */
        .lantern {
            position: absolute;
            width: 50px;
            height: 70px;
            background: linear-gradient(to bottom, #ff9966, #ff5e62);
            border-radius: 5px;
            box-shadow: 0 0 20px #ff9966, 0 0 40px #ff5e62;
            animation: floatUp linear forwards;
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 10;
        }

        .lantern::after {
            content: ''; 
            position: absolute;
            bottom: -10px;
            width: 100%;
            height: 10px;
            background: rgba(0,0,0,0.2);
            border-radius: 50%;
        }

        .lantern-text {
            position: absolute;
            top: -30px;
            color: #fff;
            font-family: 'Dancing Script', cursive;
            font-size: 1.2rem;
            white-space: nowrap;
            text-shadow: 0 0 5px #000;
        }

        @keyframes floatUp {
            0% { transform: scale(0.5) translateY(0) rotate(0deg); opacity: 0; }
            10% { opacity: 1; }
            100% { transform: scale(1) translateY(-110vh) rotate(5deg); opacity: 0.8; }
        }

        .water {
            position: absolute;
            bottom: 0;
            width: 100%;
            height: 150px;
            background: linear-gradient(to bottom, rgba(255,255,255,0.05), rgba(0,0,0,0.5));
            backdrop-filter: blur(4px);
            z-index: 5;
            pointer-events: none;
        }

        .final-link-container {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            display: none;
            text-align: center;
            z-index: 100;
            width: 90%;
        }

        .magic-btn {
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid #fff;
            color: #fff;
            padding: 15px 40px;
            font-size: 1.2rem;
            border-radius: 50px;
            text-decoration: none;
            backdrop-filter: blur(10px);
            box-shadow: 0 0 20px rgba(255, 255, 255, 0.5);
            transition: 0.4s;
            text-transform: uppercase;
            letter-spacing: 3px;
            display: inline-block;
        }

    </style>
</head>
<body>

    <audio id="bgMusic" autoplay loop>
        <source src="TikVid.io_7445837885590326533.mp3" type="audio/mpeg">
    </audio>

    <div class="instruction" id="instruction">
        Toca la pantalla para lanzar un deseo...
    </div>

    <div class="water"></div>

    <div class="final-link-container" id="finalContainer">
        <h2 style="color: white; margin-bottom: 30px; font-family: 'Dancing Script'; font-size: 2.5rem; text-shadow: 0 0 10px #fff;">Mi deseo eres tú</h2>
        
        <a href="https://elzsaxa1.github.io/YOUANJ/" class="magic-btn">
            Continuar
        </a>
    </div>

    <script>
        // --- CONFIGURACIÓN DE MÚSICA ---
        const bgMusic = document.getElementById('bgMusic');
        bgMusic.volume = 0.5;

        // Intentar reproducir al cargar
        window.onload = function() {
            bgMusic.play().catch(error => {
                console.log("Autoplay bloqueado. Se activará al tocar.");
            });
        };

        const body = document.querySelector('body');
        const instruction = document.getElementById('instruction');
        const finalContainer = document.getElementById('finalContainer');
        
        let clickCount = 0;
        const messages = ["Amor", "Felicidad", "Juntos", "Risas", "Besos", "Futuro", "Paz", "Magia", "Tú y Yo"];

        // Efecto de sonido de campanita (Web Audio API)
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        
        function playChime() {
            if (audioCtx.state === 'suspended') audioCtx.resume();
            const oscillator = audioCtx.createOscillator();
            const gainNode = audioCtx.createGain();
            oscillator.type = 'sine';
            oscillator.frequency.setValueAtTime(800 + Math.random() * 400, audioCtx.currentTime);
            gainNode.gain.setValueAtTime(0.1, audioCtx.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.0001, audioCtx.currentTime + 1.5);
            oscillator.connect(gainNode);
            gainNode.connect(audioCtx.destination);
            oscillator.start();
            oscillator.stop(audioCtx.currentTime + 1.5);
        }

        // Función Maestra de Interacción
        function handleInteraction(e) {
            
            // --- TRUCO: SI LA MÚSICA NO SUENA, ACTIVARLA AHORA ---
            if (bgMusic.paused) {
                bgMusic.play();
            }

            if(e.target.classList.contains('magic-btn')) return;
            if(e.type === 'touchstart') e.preventDefault();

            let clientX, clientY;
            if(e.type === 'touchstart') {
                clientX = e.touches[0].clientX;
                clientY = e.touches[0].clientY;
            } else {
                clientX = e.clientX;
                clientY = e.clientY;
            }

            clickCount++;
            playChime(); // Suena la campanita
            
            if (clickCount === 1) {
                instruction.style.opacity = '0';
                instruction.style.transition = 'opacity 1s';
            }

            createLantern(clientX, clientY);

            if (clickCount === 7) {
                setTimeout(() => {
                    finalContainer.style.display = 'block';
                    finalContainer.style.animation = 'pulse 1s forwards';
                }, 1000);
            }
        }

        document.addEventListener('touchstart', handleInteraction, {passive: false});
        document.addEventListener('click', handleInteraction);

        function createLantern(x, y) {
            const lantern = document.createElement('div');
            lantern.classList.add('lantern');
            
            lantern.style.left = (x - 25) + 'px';
            lantern.style.top = (y - 50) + 'px'; 

            const text = document.createElement('span');
            text.classList.add('lantern-text');
            text.innerText = messages[Math.floor(Math.random() * messages.length)];
            lantern.appendChild(text);

            const duration = Math.random() * 3 + 4 + 's';
            lantern.style.animationDuration = duration;
            
            body.appendChild(lantern);

            setTimeout(() => {
                lantern.remove();
            }, 7000);
        }
    </script>
</body>
</html>